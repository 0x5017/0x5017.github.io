<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.8.0/styles/default.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.2/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/index.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"DFIR - Windows","children":[{"content":"<strong>Computer System</strong>","children":[{"content":"Boot process","children":[{"content":"When a user push the \"Power On\" button on a computer","children":[{"content":"","children":[{"content":"Power On Self Test (POST) ==&gt; check for all hardware is working correctly (mouse, keyboard, camera etc...). If everthing is OK ==&gt; the check is ok and go for the BIOS process","children":[],"payload":{"lines":"4,5"}},{"content":"if the test is fail, you will listen to several \"beep\". It depend on the problem AND the <strong>manufacturer</strong> that you can hear the number of \"beep\".","children":[{"content":"example : 3 beep for keyboard issue.","children":[],"payload":{"lines":"6,7"}}],"payload":{"lines":"5,7"}}],"payload":{"lines":"4,7"}},{"content":"","children":[{"content":"The BIOS (Basic Input/Output System)","children":[],"payload":{"lines":"7,8"}},{"content":"","children":[{"content":"The BIOS is stored in a chip of motherboard","children":[],"payload":{"lines":"8,9"}},{"content":"The BIOS is non-volatile ==&gt; the contain of the chip BIOS will retain even the computer is turn off. <strong>Except</strong> some information like date&amp;time, boot sequence, certain hardware setting","children":[],"payload":{"lines":"9,10"}},{"content":"The BIOS will load the OS system from the storage device","children":[],"payload":{"lines":"10,11"}}],"payload":{"lines":"8,11"}}],"payload":{"lines":"7,11"}}],"payload":{"lines":"3,11"}},{"content":"UEFI is a new generation of BIOS since 2010 (so far)","children":[{"content":"New interface, faster boot time","children":[],"payload":{"lines":"12,13"}},{"content":"allow <strong>Secure boot</strong> ==&gt; stop any <strong>unsigned</strong> drivers from loading. Help to protect of rootkit","children":[],"payload":{"lines":"13,14"}}],"payload":{"lines":"11,14"}},{"content":"Different between BIOS/CMOS and UEFI <a href=\"https://www.youtube.com/watch?v=LGz0Io_dh_I\">here</a>","children":[],"payload":{"lines":"14,15"}}],"payload":{"lines":"2,15"}},{"content":"File system","children":[{"content":"A hard drive can have multiple partitions. File system track : <strong>Where the file + space available</strong>","children":[],"payload":{"lines":"16,17"}},{"content":"FAT Filesystem","children":[{"content":"<strong>File Allocation Table</strong> : has been created since the early days of computer, nearly all OS can read this file","children":[],"payload":{"lines":"18,19"}},{"content":"Today : FAT32 : 28 bits to adresses available clusters with maximum volume size of 2.2TB. Windows limited the volume size to 32 GB","children":[],"payload":{"lines":"19,20"}},{"content":"FAT filesystem contains 2 areas : System Area &amp; data Area.","children":[{"content":"<strong>FAT = System area + Data area</strong>","children":[{"content":"System area = Boot Record + FAT 1 + FAT 2","children":[{"content":"Boot Record","children":[{"content":"Contains the instructions for the initial boot process. On systems where the FAT partition is bootable, this code is executed to start loading the operating system.","children":[],"payload":{"lines":"24,25"}}],"payload":{"lines":"23,25"}},{"content":"FAT 1 and FAT 2","children":[{"content":"FAT 2 is duplicate of FAT 1","children":[],"payload":{"lines":"26,27"}}],"payload":{"lines":"25,27"}}],"payload":{"lines":"22,27"}},{"content":"Data area = Root Directory + Files","children":[{"content":"Root directory contains severals important informations","children":[{"content":"Like : first character of filename <strong>OR</strong> status, Filename, extension, creation date/time, date/time of last write, file size (0 for directory)","children":[],"payload":{"lines":"29,30"}},{"content":"if the file is deleted, the first character of the directory will change to 0xE5.","children":[],"payload":{"lines":"30,31"}}],"payload":{"lines":"28,31"}}],"payload":{"lines":"27,31"}}],"payload":{"lines":"21,31"}}],"payload":{"lines":"20,31"}}],"payload":{"lines":"17,31"}}],"payload":{"lines":"15,31"}},{"content":"NTFS File System","children":[{"content":"Default file system for Windows OS","children":[],"payload":{"lines":"32,33"}},{"content":"More complicated than FAT filesystem. but same idea :","children":[{"content":"Record metadata of the file : filename, date/time, file size","children":[],"payload":{"lines":"34,35"}},{"content":"To mark the cluster the file occupies","children":[],"payload":{"lines":"35,36"}},{"content":"to record which clusters are allocated and which clusters are unallocated","children":[{"content":"But What is clusters ?","children":[{"content":"cluster know as Allocation unit size","children":[],"payload":{"lines":"38,39"}},{"content":"It depend on the size of your partition size. But for 2GB to 2TB : 4KB per cluster","children":[],"payload":{"lines":"39,40"}},{"content":"if you store 10 KB with 4KB/cluster. You have to store in 2 clusters of 4KB and 2KB rest in the 3rd cluster","children":[],"payload":{"lines":"40,41"}},{"content":"NTFS file track this information with $MFT file","children":[],"payload":{"lines":"41,42"}}],"payload":{"lines":"37,42"}}],"payload":{"lines":"36,42"}}],"payload":{"lines":"33,42"}},{"content":"Some important system file","children":[{"content":"$MFT : <strong>list of cluster where data stream reside, index etc</strong>, also filename, filesize, date/time","children":[],"payload":{"lines":"43,44"}},{"content":"$MFTMirr : $MFT Mirror, backup of the $MFT","children":[],"payload":{"lines":"44,45"}}],"payload":{"lines":"42,45"}}],"payload":{"lines":"31,45"}}],"payload":{"lines":"1,2"}},{"content":"<strong>Investigation process</strong>","children":[{"content":"Timeline analysis","children":[{"content":"<a href=\"https://www.x-ways.net/forensics/\">X-Ways Forensics</a> great tool to track time line and track/documentation of the following source information. But payant","children":[{"content":"index.dat : records user activity on the web","children":[],"payload":{"lines":"48,49"}},{"content":"LNK files","children":[],"payload":{"lines":"49,50"}},{"content":"Registry","children":[],"payload":{"lines":"50,51"}},{"content":"Metadata of Microsoft Office file","children":[],"payload":{"lines":"51,52"}},{"content":"Recycle bin file","children":[],"payload":{"lines":"52,53"}},{"content":"Prefetch file","children":[],"payload":{"lines":"53,54"}},{"content":"Cookies from browser","children":[],"payload":{"lines":"54,55"}},{"content":"Browser history","children":[],"payload":{"lines":"55,56"}},{"content":"USNJrnl","children":[{"content":"(Update Sequence Number Journal) file is part of the NTFS file system in Windows","children":[],"payload":{"lines":"57,58"}},{"content":"log changes file system","children":[],"payload":{"lines":"58,59"}},{"content":"help AV to detect change file instead of scan entire file system","children":[],"payload":{"lines":"59,60"}}],"payload":{"lines":"56,60"}},{"content":"Event log","children":[],"payload":{"lines":"60,61"}},{"content":"Email message","children":[],"payload":{"lines":"61,62"}},{"content":"shadow copy files","children":[],"payload":{"lines":"62,63"}},{"content":"Restore points","children":[],"payload":{"lines":"63,64"}},{"content":"MAC timestamp","children":[],"payload":{"lines":"64,65"}}],"payload":{"lines":"47,65"}},{"content":"<a href=\"https://github.com/log2timeline/plaso\">PLaso</a>. Open Source and free to collect and extract data in a format that you want. Here is some main functionality","children":[{"content":"image_export","children":[{"content":"export content file","children":[],"payload":{"lines":"67,68"}},{"content":"<code>image_export.exe --names [File_name] [Source_PATH] -w [Destination_path] </code>","children":[],"payload":{"lines":"68,69"}}],"payload":{"lines":"66,69"}},{"content":"log2timeline","children":[{"content":"extract chronological events from file,directories,image.","children":[],"payload":{"lines":"70,71"}},{"content":"It will create a database file (.plaso) and can read by other tools","children":[],"payload":{"lines":"71,72"}},{"content":"Multiple plugins for android, linux, macos ...","children":[],"payload":{"lines":"72,73"}},{"content":"<code>log2timeline [Output] [Input]</code>","children":[],"payload":{"lines":"73,74"}}],"payload":{"lines":"69,74"}},{"content":"pinfo","children":[{"content":"command line to display informatoin about the (.plaso) file","children":[],"payload":{"lines":"75,76"}}],"payload":{"lines":"74,76"}},{"content":"psort","children":[{"content":"output file in several format (csv, elastic, elastic_ts (for TimeSketch), json)","children":[],"payload":{"lines":"77,78"}}],"payload":{"lines":"76,78"}},{"content":"psteal","children":[{"content":"extract log and output in an format in one step. Combination of log2timeline &amp; psort","children":[],"payload":{"lines":"79,80"}},{"content":"<code>psteal --source [Full_Path_Source_file] -o [output_format] -w [Destination_file_path]</code>","children":[],"payload":{"lines":"80,81"}}],"payload":{"lines":"78,81"}}],"payload":{"lines":"65,81"}},{"content":"Other tool like autospy, Paladin etc..","children":[],"payload":{"lines":"81,82"}}],"payload":{"lines":"46,82"}},{"content":"Media analysis","children":[{"content":"hard drive, SSD, USB, smartphone","children":[],"payload":{"lines":"83,84"}}],"payload":{"lines":"82,84"}},{"content":"string search","children":[{"content":"string.","children":[],"payload":{"lines":"85,86"}}],"payload":{"lines":"84,86"}},{"content":"Recovery deleted data","children":[],"payload":{"lines":"86,88"}}],"payload":{"lines":"45,46"}},{"content":"<strong>Windows artifact analysis</strong>","children":[{"content":"Understanding users profiles","children":[{"content":"Windows Vista, 7,8,10, 11","children":[{"content":"C:\\Users%Username%","children":[],"payload":{"lines":"91,92"}}],"payload":{"lines":"90,92"}},{"content":"Microsoft defines the different types of user profiles","children":[{"content":"Local user : this profile is created when the user logs on to a computer for the 1st time. The profile stored on the hard disk","children":[],"payload":{"lines":"93,94"}},{"content":"Roaming user : like user account in Active Directory. This profile is an administrator-created and network-based profile. When user logs in to the machine, the profile will be downloaded to the localhost. Any changes are made to the profile in localhost will be copy when user logs off from the localhost.","children":[],"payload":{"lines":"94,95"}},{"content":"Mandatory user : This profile is created by network administrators to lock users to a specific set of settings. The users will not made any change without administrator's approval.","children":[],"payload":{"lines":"95,96"}},{"content":"Temporary user : When the user log off, the profile is deleted","children":[],"payload":{"lines":"96,97"}}],"payload":{"lines":"92,97"}},{"content":"Each user profile have a registry hive - NTUSER.dat. It is mapped with the HKCU (HKEY Current User)","children":[],"payload":{"lines":"97,98"}},{"content":"Classical folder","children":[{"content":"Visible folder","children":[{"content":"Documents, Downloads, Picture, Music","children":[],"payload":{"lines":"100,101"}}],"payload":{"lines":"99,101"}},{"content":"hidden folder","children":[{"content":"Appdata","children":[{"content":"WHAT ? contains user-specfic preferences and profile configurations","children":[],"payload":{"lines":"103,104"}},{"content":"3 subfolders","children":[{"content":"Appdata\\Local","children":[{"content":"temp file and Non-essential application data such as large cached images or index files.","children":[],"payload":{"lines":"106,107"}},{"content":"example : AppData\\Local\\Microsoft\\Edge","children":[],"payload":{"lines":"107,108"}}],"payload":{"lines":"105,108"}},{"content":"Appdata\\localLow","children":[{"content":"Data from applications that run in a more restricted (lower integrity) mode, often due to security restrictions.","children":[],"payload":{"lines":"109,110"}},{"content":"example : AppData\\LocalLow\\Adobe\\Flash Player","children":[],"payload":{"lines":"110,111"}}],"payload":{"lines":"108,111"}},{"content":"Appdata\\Roaming","children":[{"content":"Settings that should \"roam\" with the user on different computers","children":[],"payload":{"lines":"112,113"}},{"content":"Synchronize with the server","children":[],"payload":{"lines":"113,114"}},{"content":"example : AppData\\Roaming\\Microsoft\\Outlook","children":[],"payload":{"lines":"114,115"}}],"payload":{"lines":"111,115"}}],"payload":{"lines":"104,115"}}],"payload":{"lines":"102,115"}}],"payload":{"lines":"101,115"}}],"payload":{"lines":"98,115"}}],"payload":{"lines":"89,115"}},{"content":"Understanding Windows registry","children":[{"content":"What is Windows registry ?","children":[{"content":"the most important, the heart of Windows OS","children":[],"payload":{"lines":"117,118"}},{"content":"Windows registry = central hierarchical database","children":[],"payload":{"lines":"118,119"}},{"content":"This db store","children":[{"content":"config information about user","children":[],"payload":{"lines":"120,121"}},{"content":"hardware device","children":[],"payload":{"lines":"121,122"}},{"content":"applications","children":[],"payload":{"lines":"122,123"}}],"payload":{"lines":"119,123"}}],"payload":{"lines":"116,123"}},{"content":"4 main hives","children":[{"content":"What is hive ?","children":[{"content":"information in %SystemRoot%\\System32\\config folder","children":[],"payload":{"lines":"125,126"}}],"payload":{"lines":"124,126"}},{"content":"SAM hive","children":[{"content":"Security Accounts Manager : contains login information about user","children":[],"payload":{"lines":"127,128"}}],"payload":{"lines":"126,128"}},{"content":"SECURITY hive","children":[{"content":"Contain security information and potentially password information","children":[],"payload":{"lines":"129,130"}}],"payload":{"lines":"128,130"}},{"content":"SOFWARE hive","children":[{"content":"information about application and default Windows settings","children":[],"payload":{"lines":"131,132"}}],"payload":{"lines":"130,132"}},{"content":"SYSTEM hive","children":[{"content":"information about hardware and system config","children":[],"payload":{"lines":"133,134"}}],"payload":{"lines":"132,134"}}],"payload":{"lines":"123,134"}}],"payload":{"lines":"115,134"}},{"content":"Account usage","children":[{"content":"Last login/last password change","children":[{"content":"Information in <code>C:\\Windows\\system32\\config\\SAM\\Domains\\Account\\Users</code>","children":[],"payload":{"lines":"136,137"}},{"content":"Tools : RegRipper","children":[],"payload":{"lines":"137,138"}},{"content":"Example","children":[{"content":"\n<pre><code data-lines=\"139,146\">    <span class=\"hljs-attribute\">Username</span>: user1[<span class=\"hljs-number\">1001</span>]\n    <span class=\"hljs-attribute\">SID</span> : S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">5</span>-<span class=\"hljs-number\">1231313123123123</span>-<span class=\"hljs-number\">32434565</span>-<span class=\"hljs-number\">1001</span>\n    <span class=\"hljs-attribute\">Account</span> created : \n    <span class=\"hljs-attribute\">Last</span> Login Date : \n    <span class=\"hljs-attribute\">Pwd</span> Reset Date :  \n</code></pre>","children":[],"payload":{"lines":"139,146"}}],"payload":{"lines":"138,146"}},{"content":"SID : long and boring string. but remember that in the last number (relative ID)","children":[{"content":"500 : Administrator","children":[],"payload":{"lines":"147,148"}},{"content":"501 : guest","children":[],"payload":{"lines":"148,149"}},{"content":"<code>&gt; 1000</code> : user-created account. each new user account created : +1 . If you can find 1001,1002,1004 ==&gt; 1003 was deleted","children":[],"payload":{"lines":"149,150"}}],"payload":{"lines":"146,150"}}],"payload":{"lines":"135,150"}},{"content":"Logon event ID","children":[{"content":"<code>C:\\Windows\\System32\\winevt\\Logs\\Security.evtx</code>","children":[{"content":"4624 : logon success (check logon type)","children":[],"payload":{"lines":"152,153"}},{"content":"4625 : Logon fail","children":[],"payload":{"lines":"153,154"}},{"content":"4634 : Logon session terminated","children":[],"payload":{"lines":"154,155"}},{"content":"4647 : Logon session terminated by the user","children":[],"payload":{"lines":"155,156"}},{"content":"4672 : user logon with admin right","children":[],"payload":{"lines":"156,157"}},{"content":"4720 : User account created","children":[],"payload":{"lines":"157,158"}},{"content":"4778 : A session was reconnected to a Window Station.","children":[],"payload":{"lines":"158,159"}},{"content":"4779 : A session was disconnected from a Window Station.","children":[],"payload":{"lines":"159,160"}}],"payload":{"lines":"151,160"}}],"payload":{"lines":"150,160"}}],"payload":{"lines":"134,160"}},{"content":"File/folder knowledge","children":[{"content":"Thumbcache file (image)","children":[{"content":"What is this ?","children":[{"content":"A database of thumbnail images created when using Windows Explorer in a thumbnail view.","children":[],"payload":{"lines":"163,164"}},{"content":"Depending on the size of the thumbnail, you may have multiple database with same image but different size","children":[],"payload":{"lines":"164,165"}},{"content":"The system can add a thumbnail to the cache without user knowledge","children":[],"payload":{"lines":"165,166"}}],"payload":{"lines":"162,166"}},{"content":"What we can do with thumbcache file ?","children":[{"content":"recover deleted or previously viewed images.","children":[],"payload":{"lines":"167,168"}}],"payload":{"lines":"166,168"}},{"content":"Where is stored ?","children":[{"content":"C:\\Users&lt;username&gt;\\AppData\\Local\\Microsoft\\Windows\\Explorer","children":[],"payload":{"lines":"169,170"}}],"payload":{"lines":"168,170"}},{"content":"Which tool can view ?","children":[{"content":"https://thumbcacheviewer.github.io/","children":[],"payload":{"lines":"171,172"}}],"payload":{"lines":"170,172"}}],"payload":{"lines":"161,172"}},{"content":"File created by browser","children":[{"content":"Microsoft browser (IE/edge/File Explorer)","children":[{"content":"What we can do ?","children":[{"content":"Open/download/delete file in internet browser of File Explorer","children":[],"payload":{"lines":"175,176"}}],"payload":{"lines":"174,176"}},{"content":"Where is stored ? Depend on the version","children":[{"content":"IE6-7 : <code>%Userprofile%\\LocalSettings\\History\\History.IE5</code>","children":[],"payload":{"lines":"177,178"}},{"content":"IE8-9 : <code>%UserProfil%\\AppData\\Local\\Microsoft\\WindowsHistory\\History.IE5</code>","children":[],"payload":{"lines":"178,179"}},{"content":"IE10-11 : <code>%UserProfil%\\AppData\\Local\\Microsoft\\Windows\\WebCache\\WebCacheV*.dat</code>","children":[],"payload":{"lines":"179,180"}}],"payload":{"lines":"176,180"}},{"content":"Tools ?","children":[{"content":"For IE10-11 (.dat file) : (ESEDatabaseView)[https://www.nirsoft.net/utils/ese_database_view.html] ==&gt; powerfull to track visited phishing mail for example","children":[],"payload":{"lines":"181,182"}}],"payload":{"lines":"180,182"}}],"payload":{"lines":"173,182"}}],"payload":{"lines":"172,182"}},{"content":"Moste recently used/recently used","children":[{"content":"MRU (Most Recently Used)","children":[{"content":"Stored in NTUSER.dat","children":[],"payload":{"lines":"184,185"}},{"content":"Multiple MRU lists in the registry file. Here are some common locations","children":[{"content":"OpenSavePidlMRU in NTUSER.dat","children":[{"content":"track last 20 files opened/saved via the Windows Common Dialogue (Open/SaveAs dialog box)","children":[],"payload":{"lines":"187,188"}},{"content":"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDIg32\\OpenSaveMRU (OpenSavePidlMRU in Vista/Win7)","children":[],"payload":{"lines":"188,189"}},{"content":"Example output :","children":[{"content":"\n<pre><code data-lines=\"190,194\">    My computer<span class=\"hljs-string\">\\CLSID_Desktop\\facture.pdf</span>\n    My computer<span class=\"hljs-string\">\\CLSID_Desktop\\my_CV.docx</span>\n</code></pre>","children":[],"payload":{"lines":"190,194"}}],"payload":{"lines":"189,194"}},{"content":"Tools : RegistryExplorer","children":[],"payload":{"lines":"194,195"}}],"payload":{"lines":"186,195"}},{"content":"lastvisitedmru","children":[],"payload":{"lines":"195,196"}}],"payload":{"lines":"185,196"}},{"content":"(interesting doc by SANS)[https://www.sans.org/blog/opensavemru-and-lastvisitedmru/]","children":[],"payload":{"lines":"196,197"}}],"payload":{"lines":"183,197"}},{"content":"RecentDocs","children":[{"content":"What ?","children":[{"content":"Contains all list of file executed/opened by the user <strong>through</strong> Windows Explorer","children":[],"payload":{"lines":"199,200"}},{"content":"example recent html open file <code>Sofware\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\\.html </code>","children":[],"payload":{"lines":"200,201"}}],"payload":{"lines":"198,201"}}],"payload":{"lines":"197,201"}},{"content":"Recycle bin","children":[{"content":"hidden folder stored in <strong>root directory</strong>","children":[],"payload":{"lines":"202,203"}},{"content":"intermediare step when a user delete a file","children":[],"payload":{"lines":"203,204"}},{"content":"On NTFS formatted disk, there will have a sub-folder for each user's SID","children":[],"payload":{"lines":"204,205"}},{"content":"When user delete a file","children":[{"content":"2 files will be create","children":[{"content":"$R + 6 random character + the extension of the file","children":[],"payload":{"lines":"207,208"}},{"content":"$I + 6 same character of the $R + the extension of the file","children":[{"content":"this will track : file size, date/time delete, original path/file name","children":[],"payload":{"lines":"209,210"}}],"payload":{"lines":"208,210"}}],"payload":{"lines":"206,210"}}],"payload":{"lines":"205,210"}},{"content":"When user delete a folder","children":[{"content":"Still have $R and $I (but no extension)","children":[],"payload":{"lines":"211,212"}},{"content":"in $R, you can find ALL data in this directory","children":[],"payload":{"lines":"212,213"}}],"payload":{"lines":"210,213"}},{"content":"Example delete file","children":[{"content":"user with SID : S-1-5-21-RANDOM-1001 - delete file test.jpg","children":[],"payload":{"lines":"214,215"}},{"content":"in cmd<pre><code data-lines=\"216,223\">    <span class=\"hljs-built_in\">cd</span> C:\\<span class=\"hljs-variable\">$Recycle</span>.bin\n    C:\\<span class=\"hljs-variable\">$Recycle</span>.Bin&gt;<span class=\"hljs-built_in\">cd</span> ./S-1-5-21-RANDOM-1001\n    <span class=\"hljs-built_in\">dir</span>\n    <span class=\"hljs-variable\">$I9129S4</span>.jpg\n    <span class=\"hljs-variable\">$R9129S4</span>.jpg\n</code></pre>","children":[],"payload":{"lines":"215,223"}}],"payload":{"lines":"213,223"}},{"content":"When user empty Recycle bin","children":[{"content":"Filesystem will update that the clusters will now available to use","children":[],"payload":{"lines":"224,225"}},{"content":"but the deleted file will move into the unallocated clusers","children":[],"payload":{"lines":"225,226"}},{"content":"you can still recover data if the $I will be resident in the MFT","children":[],"payload":{"lines":"226,227"}}],"payload":{"lines":"223,227"}}],"payload":{"lines":"201,227"}},{"content":"Shortcut file (LNK)","children":[{"content":"shortcut or link to files","children":[],"payload":{"lines":"228,229"}},{"content":"store in <code>%USername%\\Appdata\\Roaming\\Microsoft\\Windows</code>","children":[],"payload":{"lines":"229,230"}},{"content":"Read file size, path, volum, last accessed","children":[],"payload":{"lines":"230,231"}},{"content":"Information will remain even if the destination files has been deleted","children":[],"payload":{"lines":"231,232"}},{"content":"Tools to read this data ? LECmd","children":[],"payload":{"lines":"232,233"}},{"content":"this is a option that sys admin can turn off","children":[],"payload":{"lines":"233,234"}}],"payload":{"lines":"227,234"}},{"content":"Jumplists","children":[{"content":"It's a <strong>Recent folder</strong> (RÃ©cent)","children":[],"payload":{"lines":"235,236"}},{"content":"it allow user ti access frequently/recently used files from Windows taskbar","children":[],"payload":{"lines":"236,237"}},{"content":"Even if user clear out the <strong>Recent folder</strong>, it will remain the information in JumpLists","children":[],"payload":{"lines":"237,238"}},{"content":"2 types of file in Recent Folder","children":[{"content":"Automatic - system created","children":[{"content":"<code>%UserProfil%\\Appdata\\Roaming\\Microsoft\\Windows\\Recent\\Automaticdestinations</code>","children":[],"payload":{"lines":"240,241"}}],"payload":{"lines":"239,241"}},{"content":"Custom - user created","children":[{"content":"<code>%UserProfil%\\Appdata\\Roaming\\Microsoft\\Windows\\Recent\\Customdestinations</code>","children":[],"payload":{"lines":"242,243"}}],"payload":{"lines":"241,243"}}],"payload":{"lines":"238,243"}},{"content":"Tools : JumpListExplorer","children":[],"payload":{"lines":"243,244"}}],"payload":{"lines":"234,244"}},{"content":"Shellbags","children":[{"content":"set of registry keys that remember the size and location of the folder and libraries that user has accessed via GUI.","children":[],"payload":{"lines":"245,246"}},{"content":"You may find network devices, removable media, encrypted container etc...","children":[],"payload":{"lines":"246,247"}},{"content":"You can find them in USRCLASS.DAT, located in the user AppData\\Local\\Microsoft\\Windows folder","children":[],"payload":{"lines":"247,248"}},{"content":"Tools : Shellbags Explorer","children":[],"payload":{"lines":"248,249"}}],"payload":{"lines":"244,249"}},{"content":"prefetch","children":[{"content":"which programme run by wich user and how many time, and each timestamp","children":[],"payload":{"lines":"250,251"}},{"content":"%Windows%\\Prefetch","children":[],"payload":{"lines":"251,252"}}],"payload":{"lines":"249,252"}}],"payload":{"lines":"182,252"}},{"content":"special file of NTFS","children":[{"content":"$MFT (Master File Table)","children":[{"content":"tracks all files/folders changes/creation on filesystem","children":[],"payload":{"lines":"254,255"}},{"content":"Tools to read : MFTExplorer or MFTECmd than TimelineExplorer","children":[],"payload":{"lines":"255,256"}}],"payload":{"lines":"253,256"}},{"content":"$USNJrnl (Update Sequence Number (USN) Journal)","children":[{"content":"track all file/folder <strong>creation/modification/delete</strong>","children":[],"payload":{"lines":"257,258"}},{"content":"Tools : KAPE","children":[],"payload":{"lines":"258,259"}}],"payload":{"lines":"256,259"}},{"content":"$I30 Index file","children":[{"content":"track which files go to which directories.","children":[],"payload":{"lines":"260,261"}},{"content":"create/modification/delete a file, the index $I30 INDX will be update.","children":[],"payload":{"lines":"261,262"}},{"content":"Very helpfull if you have to prove the existence of a file on the system, event if it does not exist.","children":[],"payload":{"lines":"262,263"}}],"payload":{"lines":"259,263"}}],"payload":{"lines":"252,263"}},{"content":"Recover deleted file","children":[{"content":"each time you delete a file, the file changed for allocation to unallocation space","children":[],"payload":{"lines":"264,265"}},{"content":"If the db of index file is not updated, you can still recover the file","children":[],"payload":{"lines":"265,266"}},{"content":"Here is the index file : C:\\ProgramData\\Microsoft\\Search\\Data\\Applications\\Windows\\Windows.edb","children":[],"payload":{"lines":"266,267"}}],"payload":{"lines":"263,267"}}],"payload":{"lines":"160,267"}},{"content":"Identifying physical locations","children":[{"content":"Timezone","children":[{"content":"SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation","children":[],"payload":{"lines":"269,270"}}],"payload":{"lines":"268,270"}},{"content":"Network history","children":[{"content":"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList","children":[],"payload":{"lines":"271,272"}},{"content":"Wireless connexion","children":[{"content":"C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-WLAN-AutoConfigOperational.evtx","children":[],"payload":{"lines":"273,274"}},{"content":"If you know where the wireless network (look at SSID value to find wirelees name) is located ===&gt; you can find the location of user","children":[],"payload":{"lines":"274,275"}}],"payload":{"lines":"272,275"}}],"payload":{"lines":"270,275"}}],"payload":{"lines":"267,275"}},{"content":"Program execution","children":[{"content":"Some artifact of the \"file knowledge\" section will give you an idea. But you can find much more here","children":[{"content":"Recent app","children":[],"payload":{"lines":"277,278"}},{"content":"JumpLists","children":[],"payload":{"lines":"278,279"}},{"content":"MRU","children":[],"payload":{"lines":"279,280"}},{"content":"Prefetch","children":[],"payload":{"lines":"280,281"}}],"payload":{"lines":"276,281"}},{"content":"UserAssist","children":[{"content":"Track GUI-based application were lauched in the system","children":[],"payload":{"lines":"282,283"}},{"content":"NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist","children":[],"payload":{"lines":"283,284"}},{"content":"Tools : RegRipper","children":[],"payload":{"lines":"284,285"}}],"payload":{"lines":"281,285"}},{"content":"Shimcache","children":[{"content":"Track compatibility issues with executed programs","children":[],"payload":{"lines":"286,287"}},{"content":"SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache","children":[],"payload":{"lines":"287,288"}},{"content":"Tools : RegRipper","children":[],"payload":{"lines":"288,289"}}],"payload":{"lines":"285,289"}}],"payload":{"lines":"275,289"}},{"content":"Application analysis (Cours CCD)","children":[{"content":"Installed information","children":[{"content":"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths: path to the executable","children":[],"payload":{"lines":"291,292"}},{"content":"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall : name, publisher, installation location","children":[],"payload":{"lines":"292,293"}},{"content":"HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall : same information but for 64-bit system","children":[],"payload":{"lines":"293,294"}}],"payload":{"lines":"290,294"}},{"content":"persistence","children":[{"content":"Run","children":[{"content":"HKEY_LOCAL_MACHINE\\SOFWARE\\Microsoft\\Windows\\CurrentVersion\\Run","children":[],"payload":{"lines":"296,297"}},{"content":"HKEY_LOCAL_MACHINE\\SOFWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run","children":[],"payload":{"lines":"297,298"}},{"content":"NTUSER.DAT\\SOFWARE\\Microsoft\\Windows\\CurrentVersion\\Run","children":[],"payload":{"lines":"298,299"}}],"payload":{"lines":"295,299"}},{"content":"RunOnce","children":[{"content":"HKEY_LOCAL_MACHINE\\SOFWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce","children":[],"payload":{"lines":"300,301"}},{"content":"HKEY_LOCAL_MACHINE\\SOFWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce","children":[],"payload":{"lines":"301,302"}},{"content":"NTUSER.DAT\\SOFWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce","children":[],"payload":{"lines":"302,303"}}],"payload":{"lines":"299,303"}},{"content":"Task Scheduler","children":[{"content":"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks","children":[],"payload":{"lines":"304,305"}},{"content":"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree","children":[],"payload":{"lines":"305,306"}}],"payload":{"lines":"303,306"}},{"content":"DLL loading","children":[{"content":"called by rundll.exe","children":[],"payload":{"lines":"307,308"}},{"content":"HKLM\\SOFWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\","children":[],"payload":{"lines":"308,309"}}],"payload":{"lines":"306,309"}},{"content":"Winlogon (run when user logon)","children":[{"content":"HKLM\\SOFWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit","children":[],"payload":{"lines":"310,311"}},{"content":"HKLM\\SOFWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell","children":[],"payload":{"lines":"311,312"}}],"payload":{"lines":"309,312"}}],"payload":{"lines":"294,312"}},{"content":"Run on background","children":[{"content":"HKLM\\SYSTEM\\ControlSet001\\Services\\bam\\State\\UserSettings","children":[],"payload":{"lines":"313,314"}},{"content":"HKU\\SID_OF_USER\\SYSTEM\\ControlSet001\\Services\\bam\\State\\UserSettings","children":[],"payload":{"lines":"314,315"}},{"content":"NTUSER.DAT\\SYSTEM\\ControlSet001\\Services\\bam\\State\\UserSettings","children":[],"payload":{"lines":"315,316"}}],"payload":{"lines":"312,316"}}],"payload":{"lines":"289,316"}},{"content":"USB/attached devices","children":[{"content":"SYSTEM\\CurrentControlSet\\Enum\\USB","children":[],"payload":{"lines":"317,318"}},{"content":"SYSTEM\\CurrentControlSet\\Enum\\USBSTOR","children":[],"payload":{"lines":"318,320"}}],"payload":{"lines":"316,320"}}],"payload":{"lines":"88,89"}},{"content":"<strong>Memory forensics</strong>","children":[{"content":"chill chill, we have time. Not very necessary at begining","children":[],"payload":{"lines":"321,323"}}],"payload":{"lines":"320,321"}},{"content":"<strong>Email forensics</strong>","children":[],"payload":{"lines":"323,324"}},{"content":"<strong>Internet Artifacts</strong>","children":[{"content":"Browser","children":[{"content":"Chrome","children":[{"content":"Bookmars","children":[{"content":"%Users%/AppData/Local/Google/Chrome/User Data/Default/Bookmarks","children":[],"payload":{"lines":"329,330"}}],"payload":{"lines":"328,330"}},{"content":"history file (SQLit db)","children":[{"content":"%Users%/AppData/Local/Google/Chrome/User Data/","children":[],"payload":{"lines":"331,332"}}],"payload":{"lines":"330,332"}},{"content":"Cookies","children":[{"content":"%Users%/AppData/Local/Google/Chrome/User Data/Default/","children":[],"payload":{"lines":"333,334"}}],"payload":{"lines":"332,334"}},{"content":"Password","children":[{"content":"%Users%/AppData/Local/Google/Chrome/User Data/Default/","children":[],"payload":{"lines":"335,336"}},{"content":"an encrypt password","children":[],"payload":{"lines":"336,337"}},{"content":"decrupt with <a href=\"https://www.nirsoft.net/utils/chromepass.html\">Chrome Pass</a>","children":[],"payload":{"lines":"337,338"}}],"payload":{"lines":"334,338"}}],"payload":{"lines":"327,338"}}],"payload":{"lines":"326,338"}},{"content":"Social media","children":[],"payload":{"lines":"338,339"}},{"content":"P2P file sharing","children":[],"payload":{"lines":"339,340"}}],"payload":{"lines":"325,326"}}]},{"colorFreezeLevel":2})</script>
</body>
</html>
